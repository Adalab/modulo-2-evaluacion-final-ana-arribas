"use strict";const form=document.querySelector("#form"),input=document.querySelector("#input"),resultsList=document.querySelector("#results-list"),button=document.querySelector("#button"),urlBase="http://api.tvmaze.com/search/shows?q=",favouritesList=document.querySelector("#favourites-list");let series,arrayFavourites=[];const init=()=>{const e=localStorage.getItem("settingFavourites");null!==e&&(arrayFavourites=JSON.parse(e)),paintList(arrayFavourites)},searchHandler=()=>{const e=input.value.toLowerCase();fetch(urlBase+e).then(e=>e.json()).then(e=>{series=e,displayShows(e)}).catch(function(e){console.log("No se han podido cargar los datos",e)})},displayShows=e=>{if(0!==input.value.length)for(let t of e){const e=document.createElement("li"),s=document.createElement("img"),r=document.createElement("span");r.innerHTML=t.show.name,null===t.show.image?s.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV":s.src=t.show.image.medium,r.classList.add("dynamic-class-span"),s.classList.add("dynamic-class-img"),e.classList.add("list-item"),e.addEventListener("click",chooseFavourite),e.addEventListener("click",setShows),e.appendChild(r),e.appendChild(s),resultsList.appendChild(e)}else alert("introduce una serie")},chooseFavourite=e=>{e.currentTarget.classList.toggle("selected")},introForSearch=e=>{e.preventDefault(),searchHandler()},hidePreviousResults=()=>{null!==resultsList.innerHTML&&(resultsList.innerHTML="")},setShows=e=>{const t=e.currentTarget.querySelector(".dynamic-class-span"),s=e.currentTarget.querySelector(".dynamic-class-img");let r={name:t.innerHTML,img:s.src};arrayFavourites.push(r),localStorage.setItem("settingFavourites",JSON.stringify(arrayFavourites)),PermanentList(r)},paintList=e=>{for(let t of e)PermanentList(t)},PermanentList=e=>{const t=document.createElement("li"),s=document.createElement("span"),r=document.createElement("img"),a=document.createElement("button");s.innerHTML=e.name,r.src=e.img,a.innerHTML="Quitar de favoritos",a.classList.add("delete"),t.classList.add("fav-list-item"),s.classList.add("fav-list-title"),t.appendChild(s),t.appendChild(r),t.appendChild(a),favouritesList.appendChild(t);const i=document.querySelectorAll(".delete");for(let e=0;e<i.length;e++)i[e].setAttribute("index",e),i[e].addEventListener("click",deleteFavourite)},deleteFavourite=e=>{const t=JSON.parse(localStorage.getItem("settingFavourites")),s=e.target.index;console.log(s);const r=t.splice(s,1);localStorage.setItem("settingFavourites",JSON.stringify(r)),e.target.closest("li").remove()};button.addEventListener("click",hidePreviousResults),button.addEventListener("click",searchHandler),form.addEventListener("submit",introForSearch),window.addEventListener("load",init);