"use strict";const form=document.querySelector("#form"),input=document.querySelector("#input"),resultsList=document.querySelector("#results-list"),button=document.querySelector("#button"),urlBase="http://api.tvmaze.com/search/shows?q=",favouritesList=document.querySelector("#favourites-list");let arrayFavourites=[];const init=()=>{const e=localStorage.getItem("settingFavourites");null!==e&&(arrayFavourites=JSON.parse(e)),paintList(arrayFavourites)},searchHandler=()=>{const e=input.value.toLowerCase();fetch(urlBase+e).then(e=>e.json()).then(e=>displayShows(e)).catch(function(e){console.log("No se han podido cargar los datos",e)})},displayShows=e=>{if(0!==input.value.length)for(let t of e){const e=document.createElement("li"),r=document.createElement("img"),s=document.createElement("span");s.innerHTML=t.show.name,null===t.show.image?r.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV":r.src=t.show.image.medium,s.classList.add("dynamic-class-span"),r.classList.add("dynamic-class-img"),e.addEventListener("click",chooseFavourite),e.addEventListener("click",setShows),e.appendChild(s),e.appendChild(r),resultsList.appendChild(e)}else alert("introduce una serie")},chooseFavourite=e=>{e.currentTarget.classList.toggle("selected")},introForSearch=e=>{e.preventDefault(),searchHandler()},hidePreviousResults=()=>{null!==resultsList.innerHTML&&(resultsList.innerHTML="")},setShows=e=>{const t=e.currentTarget.querySelector(".dynamic-class-span"),r=e.currentTarget.querySelector(".dynamic-class-img");let s={name:t.innerHTML,img:r.src};arrayFavourites.push(s),localStorage.setItem("settingFavourites",JSON.stringify(arrayFavourites)),PermanentList(s)},paintList=e=>{for(let t of e)PermanentList(t)},PermanentList=e=>{const t=document.createElement("li"),r=document.createElement("span"),s=document.createElement("img"),n=document.createElement("button");r.innerHTML=e.name,s.src=e.img,n.innerHTML="Borrar",n.classList.add("delete"),t.appendChild(r),t.appendChild(n),t.appendChild(s),favouritesList.appendChild(t);const a=document.querySelectorAll(".delete");for(let e of a)e.addEventListener("click",deleteFavourite)},deleteFavourite=e=>{const t=localStorage.getItem("settingFavourites");e.target.closest("li").remove(),arrayFavourites=JSON.parse(t);const r=e.target.parentElement.innerHTML,s=arrayFavourites.indexOf(r);console.log(s)};button.addEventListener("click",hidePreviousResults),button.addEventListener("click",searchHandler),form.addEventListener("submit",introForSearch),window.addEventListener("load",init);